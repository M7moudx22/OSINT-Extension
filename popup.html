<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>OSINT Extension</title>
    <style>
      :root {
        --accent: #6366f1;
        --btn: #4f46e5;
        --muted: #8b94a5;
        --success: #10b981;
        --warning: #f59e0b;
      }
      body {
        width: 680px;
        margin: 0;
        padding: 12px;
        background: #0a0f1c;
        color: #e6eef8;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        font-size: 13px;
      }
      .top {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 8px;
      }
      .app-icon {
        width: 44px;
        height: 44px;
        border-radius: 8px;
        background: linear-gradient(135deg, var(--accent), #7c3aed);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        color: white;
        font-size: 16px;
      }
      .title {
        font-size: 16px;
        font-weight: 600;
      }
      #urlInput {
        width: 100%;
        padding: 8px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        background: #0b1220;
        color: #e6eef8;
        margin-top: 8px;
        box-sizing: border-box;
      }
      .section {
        background: rgba(255, 255, 255, 0.02);
        padding: 8px;
        border-radius: 8px;
        margin-top: 10px;
        border: 1px solid rgba(255, 255, 255, 0.04);
      }
      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }
      .section h4 {
        margin: 0;
        font-size: 12px;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .open-all-btn {
        padding: 4px 8px;
        border-radius: 4px;
        border: 1px solid var(--accent);
        background: transparent;
        color: var(--accent);
        font-size: 10px;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
      }
      .open-all-btn:hover {
        background: var(--accent);
        color: white;
      }
      .open-all-btn:active {
        transform: scale(0.95);
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 6px;
      }
      .btn {
        padding: 6px 8px;
        border-radius: 6px;
        border: none;
        background: var(--btn);
        color: white;
        font-size: 11px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .btn:hover {
        background: #4338ca;
        transform: translateY(-1px);
      }
      .btn:active {
        transform: translateY(1px);
      }
      .btn svg {
        width: 12px;
        height: 12px;
        opacity: 0.95;
      }
      .links {
        margin-top: 8px;
        display: flex;
        gap: 6px;
        justify-content: center;
        border-top: 1px solid rgba(255, 255, 255, 0.04);
        padding-top: 8px;
      }
      a.link {
        color: var(--muted);
        font-size: 11px;
        text-decoration: none;
        transition: color 0.2s;
      }
      a.link:hover {
        color: var(--accent);
        text-decoration: underline;
      }
      .dork-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 4px;
      }
      .dork-btn {
        padding: 4px 6px;
        font-size: 9px;
        background: rgba(79, 70, 229, 0.7);
      }
      .dork-category {
        margin-bottom: 10px;
        background: rgba(255, 255, 255, 0.01);
        padding: 6px;
        border-radius: 6px;
        border: 1px solid rgba(255, 255, 255, 0.02);
      }
      .dork-category-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 6px;
      }
      .dork-category > strong {
        font-size: 10px;
        color: var(--muted);
        display: block;
        margin-bottom: 5px;
      }
      .dork-open-all-btn {
        padding: 3px 6px;
        border-radius: 3px;
        border: 1px solid rgba(99, 102, 241, 0.6);
        background: transparent;
        color: rgba(99, 102, 241, 0.8);
        font-size: 9px;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
      }
      .dork-open-all-btn:hover {
        background: rgba(99, 102, 241, 0.2);
        color: var(--accent);
        border-color: var(--accent);
      }
      .dork-open-all-btn:active {
        transform: scale(0.95);
      }
      /* NOT_FILTERS checkbox style */
      .not-filters-checkbox {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 10px;
        color: var(--muted);
        cursor: pointer;
      }

      .not-filters-checkbox input[type="checkbox"] {
        margin: 0;
        cursor: pointer;
      }      
      /* Keywords management */
      .keywords-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 12px 0 8px 0;
      }
      .keywords-controls {
        display: flex;
        gap: 6px;
        align-items: center;
      }
      .keywords-btn {
        padding: 4px 8px;
        border-radius: 4px;
        border: none;
        font-size: 10px;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
      }
      .upload-btn {
        background: var(--success);
        color: white;
      }
      .reset-btn {
        background: var(--warning);
        color: white;
      }
      .keywords-btn:hover {
        opacity: 0.9;
      }
      .keywords-btn:active {
        transform: scale(0.95);
      }
      .keywords-input-container {
        position: relative;
        margin-bottom: 8px;
        transition: all 0.3s ease;
        max-height: 120px;
        overflow: hidden;
      }
      .keywords-input-container.collapsed {
        max-height: 36px;
      }
      .keywords-input {
        width: 100%;
        padding: 8px 30px 8px 8px;
        border-radius: 6px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(11, 18, 32, 0.8);
        color: #e6eef8;
        font-size: 11px;
        resize: none;
        min-height: 60px;
        box-sizing: border-box;
      }
      .keywords-input::placeholder {
        color: rgba(139, 148, 165, 0.6);
      }
      .toggle-input-btn {
        position: absolute;
        right: 6px;
        top: 6px;
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: var(--muted);
        border-radius: 4px;
        width: 24px;
        height: 24px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
      }
      .toggle-input-btn:hover {
        background: rgba(255, 255, 255, 0.15);
      }
      .keywords-status {
        font-size: 10px;
        color: var(--muted);
        margin-top: 4px;
        padding: 2px 6px;
        border-radius: 3px;
        background: rgba(255, 255, 255, 0.05);
        display: inline-block;
      }
      .keywords-status.custom {
        color: var(--success);
        background: rgba(16, 185, 129, 0.1);
      }
      .file-input {
        display: none;
      }
      /* add small styles for jobs list */
      #otxJobs { margin: 8px 0; padding: 6px; border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; max-height: 200px; overflow:auto; }
      .otx-job { display:flex; justify-content:space-between; align-items:center; padding:4px 0; border-bottom:1px solid rgba(255,255,255,0.05); }
      .otx-job:last-child { border-bottom: none; }
      .otx-job button { margin-left:8px; padding: 2px 6px; font-size: 10px; }
    </style>
  </head>
  <body>
    <div class="top">
      <div class="app-icon">OS</div>
      <div>
        <div class="title">OSINT Extension</div>
      </div>
    </div>

    <div>
      <strong>Running OTX jobs</strong>
      <div id="otxJobs"><em>No active jobs</em></div>
    </div>
    
    <input id="urlInput" placeholder="Enter URL or domain" />

    <!-- Search Engines -->
    <div class="section">
      <div class="section-header">
        <h4>üîç Search Engines</h4>
        <button class="open-all-btn" data-group="search">Open All</button>
      </div>
      <div class="grid" data-group="search">
        <button class="btn" data-action="google_search">Google (site:)</button>
        <button class="btn" data-action="bing_search">Bing (site:)</button>
        <button class="btn" data-action="duckduckgo">DuckDuckGo (site:)</button>
        <button class="btn" data-action="yandex">Yandex (site:)</button>
      </div>
    </div>

    <!-- Archives -->
    <div class="section">
      <div class="section-header">
        <h4>üì¶ Archives</h4>
        <button class="open-all-btn" data-group="archives">Open All</button>
      </div>
      <div class="grid" data-group="archives">
        <button class="btn" data-action="wayback_web">Wayback GUI</button>
        <button class="btn" data-action="archive_full">Wayback CDX Full</button>
        <button class="btn" data-action="archive_simple">Wayback CDX Simple</button>
        <button class="btn" data-action="virustotal">VirusTotal</button>
        <button class="btn" data-action="virustotal_ip">VirusTotal (IP)</button>
        <button class="btn" data-action="urlscan">URLScan</button>
        <button class="btn" data-action="otx_hostname">OTX Hostname</button>
        <button class="btn" data-action="otx_domain">OTX Domain</button>
      </div>
    </div>

    <!-- Certs & Subdomains -->
    <div class="section">
      <div class="section-header">
        <h4>üîê Certs & Enum Subdomains</h4>
        <button class="open-all-btn" data-group="certs">Open All</button>
      </div>
      <div class="grid" data-group="certs">
        <button class="btn" data-action="securitytrails">SecurityTrails</button>
        <button class="btn" data-action="crtsh_cn">crt.sh (CN=)</button>
        <button class="btn" data-action="crtsh_o">crt.sh (O=)</button>
        <button class="btn" data-action="subdomainfinder">SubdomainFinder</button>
      </div>
    </div>

    <!-- Shodan & IPs -->
    <div class="section">
      <div class="section-header">
        <h4>üåê Shodan & IPs Discovery</h4>
        <button class="open-all-btn" data-group="shodan">Open All</button>
      </div>
      <div class="grid" data-group="shodan">
        <button class="btn" data-action="shodan_ssl">Shodan (SSL)</button>
        <button class="btn" data-action="shodan_org">Shodan (Org)</button>
        <button class="btn" data-action="shodan_cn">Shodan (CN)</button>
        <button class="btn" data-action="netlas_host">Netlas (Host)</button>
        <button class="btn" data-action="netlas_subdomain">Netlas (Subdomain)</button>
        <button class="btn" data-action="rapiddns">RapidDNS</button>
      </div>
    </div>

    <!-- Leakix & Others -->
    <div class="section">
      <div class="section-header">
        <h4>üíß Leakix & Others</h4>
        <button class="open-all-btn" data-group="leakix">Open All</button>
      </div>
      <div class="grid" data-group="leakix">
        <button class="btn" data-action="leakix_plugin">LeakIX (Plugin)</button>
        <button class="btn" data-action="leakix_service">LeakIX (Service)</button>
        <button class="btn" data-action="leakix_recent">LeakIX (Recent)</button>
        <button class="btn" data-action="toolbox_dig">Google DIG</button>
        <button class="btn" data-action="csp_evaluator">CSP Evaluator</button>
        <button class="btn" data-action="sslshopper">SSL Checker</button>
      </div>
    </div>

<!-- Updated GitHub Dorking Advanced section -->
<div class="section">
  <div class="section-header">
    <h4>üêô GitHub Dorking (Advanced)</h4>
    <div class="keywords-controls">
      <label class="not-filters-checkbox">
        <input type="checkbox" id="notFiltersCheckbox" checked>
        <span>Apply NOT filters</span>
      </label>
      <button class="keywords-btn upload-btn" id="uploadKeywordsBtn">üìÅ Upload Keywords</button>
      <input type="file" id="keywordsFile" class="file-input" accept=".txt,.json">
      <button class="keywords-btn reset-btn" id="resetKeywordsBtn">Reset</button>
    </div>
  </div>
  
  <!-- Keywords Input -->
  <div class="keywords-input-container collapsed" id="keywordsInputContainer">
    <textarea 
      id="keywordsInput" 
      class="keywords-input" 
      placeholder="Enter keywords (one per line) or paste comma-separated list. These will be used in GitHub dorks. Default keywords will be used if empty."
    ></textarea>
    <button class="toggle-input-btn" id="toggleInputBtn">‚ñº</button>
  </div>
  
  <div id="keywordsStatus" class="keywords-status">Using default keywords (19)</div>
  <div id="notFiltersStatus" class="keywords-status" style="margin-top: 4px;">NOT filters: Enabled</div>
  
  <!-- Email & Username Patterns -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>üìß Email & Username Patterns</strong>
      <button class="dork-open-all-btn" data-group="github_email">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_email">
      <button class="btn dork-btn" data-action="github_dork_1">Email (3+ subs to SLD)</button>
      <button class="btn dork-btn" data-action="github_dork_2">Email (3+ subs to domain)</button>
    </div>
  </div>

  <!-- URL Protocol / URL Exposure -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>üîó URL Protocol / URL Exposure</strong>
      <button class="dork-open-all-btn" data-group="github_url">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_url">
      <button class="btn dork-btn" data-action="github_dork_3">URL proto (to domain)</button>
      <button class="btn dork-btn" data-action="github_dork_4">URL proto (to SLD)</button>
      <button class="btn dork-btn" data-action="github_dork_5">URL proto + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_6">Email + keywords</button>
    </div>
  </div>

  <!-- Credentials in URLs -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>üîë Credentials in URLs</strong>
      <button class="dork-open-all-btn" data-group="github_creds">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_creds">
      <button class="btn dork-btn" data-action="github_dork_7">Email + keywords + .env</button>
      <button class="btn dork-btn" data-action="github_dork_8">Email + keywords</button>
    </div>
  </div>

  <!-- Secrets / Tokens -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>üîê Secrets / Tokens</strong>
      <button class="dork-open-all-btn" data-group="github_secrets">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_secrets">
      <button class="btn dork-btn" data-action="github_dork_9">Org search + keywords</button>
    </div>
  </div>

  <!-- ServiceNow -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>‚öôÔ∏è ServiceNow</strong>
      <button class="dork-open-all-btn" data-group="github_servicenow">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_servicenow">
      <button class="btn dork-btn" data-action="github_dork_10">SN host pattern 1</button>
      <button class="btn dork-btn" data-action="github_dork_11">SN host pattern 2</button>
      <button class="btn dork-btn" data-action="github_dork_12">SN host pattern 3</button>
      <button class="btn dork-btn" data-action="github_dork_13">SN host pattern 4</button>
      <button class="btn dork-btn" data-action="github_dork_14">SN reversed 1</button>
      <button class="btn dork-btn" data-action="github_dork_15">SN reversed 2</button>
      <button class="btn dork-btn" data-action="github_dork_29">SN to domain 1</button>
      <button class="btn dork-btn" data-action="github_dork_30">SN to domain 2</button>
    </div>
  </div>

  <!-- JDBC / Database Credentials -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>üóÑÔ∏è JDBC / Database</strong>
      <button class="dork-open-all-btn" data-group="github_jdbc">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_jdbc">
      <button class="btn dork-btn" data-action="github_dork_16">JDBC URL + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_17">JDBC no protocol</button>
      <button class="btn dork-btn" data-action="github_dork_18">JDBC proto + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_19">JDBC @// + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_20">JDBC @ + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_31">JDBC to domain + kewords</button>
      <button class="btn dork-btn" data-action="github_dork_32">JDBC no proto domain</button>
      <button class="btn dork-btn" data-action="github_dork_33">JDBC proto domain + kewords</button>
      <button class="btn dork-btn" data-action="github_dork_34">JDBC @// domain + kewords</button>
      <button class="btn dork-btn" data-action="github_dork_35">JDBC @ domain + kewords</button>
    </div>
  </div>

  <!-- CI/CD Platforms -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>üîß CI/CD Platforms</strong>
      <button class="dork-open-all-btn" data-group="github_cicd">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_cicd">
      <button class="btn dork-btn" data-action="github_dork_21">Jenkins + SLD kewords</button>
      <button class="btn dork-btn" data-action="github_dork_22">Jenkins + domain kewords</button>
      <button class="btn dork-btn" data-action="github_dork_23">JFrog + SLD kewords</button>
      <button class="btn dork-btn" data-action="github_dork_24">JFrog + domain kewords</button>
      <button class="btn dork-btn" data-action="github_dork_25">GitLab + SLD kewords</button>
      <button class="btn dork-btn" data-action="github_dork_26">GitLab + domain kewords</button>
      <button class="btn dork-btn" data-action="github_dork_27">GitHub + SLD kewords</button>
      <button class="btn dork-btn" data-action="github_dork_28">GitHub + domain kewords</button>
      <button class="btn dork-btn" data-action="github_dork_36">Jenkins domain + SLD</button>
      <button class="btn dork-btn" data-action="github_dork_37">Jenkins domain + domain</button>
      <button class="btn dork-btn" data-action="github_dork_38">JFrog domain + SLD</button>
      <button class="btn dork-btn" data-action="github_dork_39">JFrog domain + domain</button>
      <button class="btn dork-btn" data-action="github_dork_40">GitLab domain + SLD</button>
      <button class="btn dork-btn" data-action="github_dork_41">GitLab domain + domain</button>
      <button class="btn dork-btn" data-action="github_dork_42">GitHub domain + SLD</button>
      <button class="btn dork-btn" data-action="github_dork_43">GitHub domain + domain</button>
    </div>
  </div>

  <!-- Cloud & Auth Platforms -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>‚òÅÔ∏è Cloud & Auth Platforms</strong>
      <button class="dork-open-all-btn" data-group="github_cloud">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_cloud">
      <button class="btn dork-btn" data-action="github_dork_50">GCP Service Accounts</button>
      <button class="btn dork-btn" data-action="github_dork_53">Auth0 + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_54">Okta + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_55">JFrog.io + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_56">OneLogin + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_57">Looker + keywords</button>
      <button class="btn dork-btn" data-action="github_dork_58">Jenkins generic + kewords</button>
    </div>
  </div>

  <!-- Miscellaneous -->
  <div class="dork-category">
    <div class="dork-category-header">
      <strong>üì¶ Miscellaneous</strong>
      <button class="dork-open-all-btn" data-group="github_misc">Open All</button>
    </div>
    <div class="dork-grid" data-group="github_misc">
      <button class="btn dork-btn" data-action="github_dork_44">Confluence + SLD kewords</button>
      <button class="btn dork-btn" data-action="github_dork_45">SAP + domain keywords</button>
      <button class="btn dork-btn" data-action="github_dork_46">ODBC connections</button>
      <button class="btn dork-btn" data-action="github_dork_47">MongoDB connections</button>
      <button class="btn dork-btn" data-action="github_dork_48">Redis connections</button>
      <button class="btn dork-btn" data-action="github_dork_49">Couchbase connections</button>
      <button class="btn dork-btn" data-action="github_dork_51">Confluence domain + kewords</button>
      <button class="btn dork-btn" data-action="github_dork_52">SAP to domain + kewords</button>
    </div>
  </div>

</div>

    <div class="links">
      <a class="link" href="#" id="openGithub">GitHub</a>
      <a class="link" href="#" id="openIssues">Report Issue</a>
      <a class="link" href="#" id="openWiki">Documentation</a>
    </div>
    <script src="popup.js"></script>
  </body>
</html>